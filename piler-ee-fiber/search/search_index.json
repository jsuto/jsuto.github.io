{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Piler enterprise documentation","text":""},{"location":"#generic-notes","title":"Generic notes","text":"<p>GDPR related notes</p> <p>Piler Verfahrensdokumentation Enterprise Edition</p>"},{"location":"#new-features","title":"New features","text":"<p>New features in 2.0.0</p>"},{"location":"#for-end-users","title":"For end users","text":"<p>End user guide to piler enterprise edition</p>"},{"location":"#for-administrators","title":"For administrators","text":"<p>Overview</p> <p>Email archive sizing calculator</p> <p>Release notes</p> <p>Upgrading piler enterprise</p> <p>Installing piler enterprise edition</p> <p>Tuning the archive</p> <p>Benchmarking the archive</p> <p>UI config options</p> <p>Using S3 compatible storage</p> <p>Securing the archive</p>"},{"location":"benchmarks/","title":"Benchmarking the new fiber UI","text":"<p>This documentation applies to Piler enterprise edition 2.0.0</p> <p>Revision #1</p> <p>Publication date: 2025-SEP-26</p> <p>Piler enterprise has a new web app backend. While the 1.x series relies on nginx+PHP, the 2.x series has been rewritten using Go Fiber. While the look of the UI is the same, the backend offers a much better performance.</p>"},{"location":"benchmarks/#benchmark-comparison","title":"Benchmark comparison","text":"<p>The below numbers apply to a virtual machine (VM) having 2 vCPUs and 2 GB memory. Both the fiber and the nginx+php combo have been hit by the k6 performance testing tool using 50 virtual users (VU) for 30s.</p> <p>The search test used an array of 5 search expressions. The view test used an array of 5 messages ranging from 6 kB to 300 kB. Also the search test included a 0.001s delay between requests.</p>"},{"location":"benchmarks/#the-results","title":"The results","text":"Type fiber nginx+php Search 28-29k 9.2k View 18k 1.7k <p>The results indicate that the fiber UI outperforms the legacy UI by a factor of 3 when searching, and by a factor of 10 when retrieving emails from the storage.</p>"},{"location":"benchmarks/#why-nginxphp-fpm-tops-out-earlier","title":"Why nginx/php-fpm tops out earlier","text":"<p>Context switching: PHP-FPM spawns pools of workers, each a separate process. Even with tuning, there\u2019s higher scheduling overhead compared to Fiber goroutines.</p> <p>IPC overhead: Every request goes through nginx \u2192 fastcgi interface \u2192 PHP-FPM socket. Fiber skips this layer.</p> <p>Memory pressure: With 2 GB RAM, each PHP-FPM worker might use 20\u201350 MB under load. 50 workers could eat most of your RAM, so pm.max_children can\u2019t be raised too high.</p> <p>PHP runtime cost: Each request must bootstrap PHP, autoload, parse code paths, etc. Fiber just dispatches Go handlers in memory.</p> <p>The throughput ceiling is in the PHP code execution itself (runtime overhead + DB roundtrips).</p> <p>That\u2019s why Fiber is already giving you a 3\u00d7 boost with the same DB backend and hardware.</p>"},{"location":"fiber-ui-config-options/","title":"UI configuration options","text":"<p>This documentation applies to Piler enterprise edition 2.0.0</p> <p>Revision #1</p> <p>Publication date: 2025-SEP-09</p>"},{"location":"fiber-ui-config-options/#piler_key","title":"PILER_KEY","text":"<p>Default value: <code>/etc/piler/piler.key</code></p> <p>Description: Path to the private key file used by Piler for signing and cryptographic operations.</p>"},{"location":"fiber-ui-config-options/#retriever_method","title":"RETRIEVER_METHOD","text":"<p>Default value: <code>direct</code></p> <p>Description: Defines how archived emails are retrieved. Options:</p> <ul> <li><code>direct</code>: Read directly from storage</li> <li><code>socket</code>: Use a UNIX domain socket connection</li> <li><code>s3</code>: Retrieve from Amazon S3 or compatible storage</li> </ul>"},{"location":"fiber-ui-config-options/#log_level","title":"LOG_LEVEL","text":"<p>Default value: <code>INFO</code></p> <p>Description: Sets the logging verbosity level. Possible values: <code>DEBUG</code>, <code>INFO</code>, <code>WARN</code>, <code>ERROR</code>.</p>"},{"location":"fiber-ui-config-options/#log_format","title":"LOG_FORMAT","text":"<p>Default value: <code>json</code></p> <p>Description: Output format of logs. Options: <code>json</code>, <code>plain</code>.</p>"},{"location":"fiber-ui-config-options/#username","title":"USERNAME","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Username for the UI to run when started as root.</p>"},{"location":"fiber-ui-config-options/#license_file","title":"LICENSE_FILE","text":"<p>Default value: <code>./license.jwt</code></p> <p>Description: Path to the license file containing a signed license token.</p>"},{"location":"fiber-ui-config-options/#listen_addr","title":"LISTEN_ADDR","text":"<p>Default value: <code>:3000</code></p> <p>Description: Address and port where the Fiber web application will listen for HTTP requests.</p>"},{"location":"fiber-ui-config-options/#trusted_proxies","title":"TRUSTED_PROXIES","text":"<p>Default value: <code>127.0.0.1</code></p> <p>Description: Comma-separated list of trusted proxy IP addresses for handling forwarded headers.</p>"},{"location":"fiber-ui-config-options/#proxy_header","title":"PROXY_HEADER","text":"<p>Default value: <code>X-Forwarded-For</code></p> <p>Description: HTTP header used to extract the real client IP address when behind a proxy.</p>"},{"location":"fiber-ui-config-options/#retriever_socket","title":"RETRIEVER_SOCKET","text":"<p>Default value: <code>/var/piler/sockets/retriever.sock</code></p> <p>Description: Path to the UNIX domain socket used when <code>RETRIEVER_METHOD=socket</code>.</p>"},{"location":"fiber-ui-config-options/#mysql_user","title":"MYSQL_USER","text":"<p>Default value: <code>piler</code></p> <p>Description: MySQL database username.</p>"},{"location":"fiber-ui-config-options/#mysql_password","title":"MYSQL_PASSWORD","text":"<p>Default value: <code>piler123</code></p> <p>Description: MySQL database password.</p>"},{"location":"fiber-ui-config-options/#mysql_host","title":"MYSQL_HOST","text":"<p>Default value: <code>localhost:3306</code></p> <p>Description: Host and port of the MySQL server.</p>"},{"location":"fiber-ui-config-options/#mysql_max_open_conn","title":"MYSQL_MAX_OPEN_CONN","text":"<p>Default value: <code>50</code></p> <p>Description: Maximum number of open MySQL connections per child process.</p>"},{"location":"fiber-ui-config-options/#mysql_max_idle_conn","title":"MYSQL_MAX_IDLE_CONN","text":"<p>Default value: <code>20</code></p> <p>Description: Maximum number of idle MySQL connections in the connection pool.</p>"},{"location":"fiber-ui-config-options/#mysql_conn_max_lifetime","title":"MYSQL_CONN_MAX_LIFETIME","text":"<p>Default value: <code>300s</code></p> <p>Description: Maximum lifetime of a MySQL connection before it is recycled.</p>"},{"location":"fiber-ui-config-options/#manticore_dsn","title":"MANTICORE_DSN","text":"<p>Default value: <code>piler:piler123@tcp(localhost:9306)/?parseTime=true</code></p> <p>Description: DSN for connecting to Manticore search engine (read/write).</p>"},{"location":"fiber-ui-config-options/#manticore_readonly_dsn","title":"MANTICORE_READONLY_DSN","text":"<p>Default value: <code>piler:piler123@tcp(localhost:9307)/?parseTime=true</code></p> <p>Description: DSN for connecting to Manticore search engine (read-only).</p>"},{"location":"fiber-ui-config-options/#redis_addr","title":"REDIS_ADDR","text":"<p>Default value: <code>127.0.0.1:6379</code></p> <p>Description: Redis server address.</p>"},{"location":"fiber-ui-config-options/#tenant_rate_limit_per_minute","title":"TENANT_RATE_LIMIT_PER_MINUTE","text":"<p>Default value: <code>20000</code></p> <p>Description: Maximum number of requests allowed per tenant per minute.</p>"},{"location":"fiber-ui-config-options/#io_rate_limit_per_route","title":"IO_RATE_LIMIT_PER_ROUTE","text":"<p>Default value: <code>200</code></p> <p>Description: I/O rate limit for routes that retrieves emails or attachments from the storage, eg. view, download, attachments (requests per second).</p>"},{"location":"fiber-ui-config-options/#dev_mode","title":"DEV_MODE","text":"<p>Default value: <code>false</code></p> <p>Description: Enables development mode with relaxed security and verbose logging.</p>"},{"location":"fiber-ui-config-options/#node_type","title":"NODE_TYPE","text":"<p>Default value: <code>master</code></p> <p>Description: Role of the current node in a multi-node setup. Options: <code>master</code>, <code>worker</code>.</p>"},{"location":"fiber-ui-config-options/#workers","title":"WORKERS","text":"<p>Default value: <code>\"\"</code></p> <p>Description: List of worker node addresses (for multi-node setups).</p>"},{"location":"fiber-ui-config-options/#jwt_secret","title":"JWT_SECRET","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Secret key used to sign JWT tokens.</p>"},{"location":"fiber-ui-config-options/#enable_category","title":"ENABLE_CATEGORY","text":"<p>Default value: <code>true</code></p> <p>Description: Enable or disable category handling in the UI.</p>"},{"location":"fiber-ui-config-options/#enable_redact","title":"ENABLE_REDACT","text":"<p>Default value: <code>true</code></p> <p>Description: Enable or disable text redaction in the UI.</p>"},{"location":"fiber-ui-config-options/#languages","title":"LANGUAGES","text":"<p>Default value: <code>de,en,es,fr,zh</code></p> <p>Description: List of supported UI languages.</p>"},{"location":"fiber-ui-config-options/#locale","title":"LOCALE","text":"<p>Default value: <code>en-US</code></p> <p>Description: Default locale used for formatting dates and text.</p>"},{"location":"fiber-ui-config-options/#login_logo","title":"LOGIN_LOGO","text":"<p>Default value: <code>/assets/images/login-logo.svg</code></p> <p>Description: Path to the logo displayed on the login page.</p>"},{"location":"fiber-ui-config-options/#header_logo","title":"HEADER_LOGO","text":"<p>Default value: <code>/assets/images/logo-header.svg</code></p> <p>Description: Path to the logo displayed in the application header.</p>"},{"location":"fiber-ui-config-options/#toast_logo","title":"TOAST_LOGO","text":"<p>Default value: <code>/assets/images/logo-round.svg</code></p> <p>Description: Path to the logo used in toast notifications.</p>"},{"location":"fiber-ui-config-options/#header_link","title":"HEADER_LINK","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Custom link displayed in the application header.</p>"},{"location":"fiber-ui-config-options/#header_link_title","title":"HEADER_LINK_TITLE","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Title text for the header link.</p>"},{"location":"fiber-ui-config-options/#max_content_length_to_display","title":"MAX_CONTENT_LENGTH_TO_DISPLAY","text":"<p>Default value: <code>30000</code></p> <p>Description: Maximum content size (in bytes) to render in the UI. Longer messages are truncated in the message preview, but other than that the message is still intact.</p>"},{"location":"fiber-ui-config-options/#rt_index","title":"RT_INDEX","text":"<p>Default value: <code>true</code></p> <p>Description: Enable or disable real-time indexing.</p>"},{"location":"fiber-ui-config-options/#extra_notes","title":"EXTRA_NOTES","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Custom notes displayed in the login page.</p>"},{"location":"fiber-ui-config-options/#multitenancy","title":"MULTITENANCY","text":"<p>Default value: <code>false</code></p> <p>Description: Enable or disable multi-tenant mode.</p>"},{"location":"fiber-ui-config-options/#multinodes","title":"MULTINODES","text":"<p>Default value: <code>false</code></p> <p>Description: Enable or disable multi-node mode.</p>"},{"location":"fiber-ui-config-options/#css","title":"CSS","text":"<p>Default value:  </p> <pre><code>&lt;link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\"&gt; \n&lt;link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css\"&gt; \n&lt;link rel=\"stylesheet\" href=\"/assets/css/style.css\"&gt;\n</code></pre> <p>Description: Built-in CSS includes for styling the UI.</p>"},{"location":"fiber-ui-config-options/#custom_css","title":"CUSTOM_CSS","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Custom CSS overrides for the UI.</p>"},{"location":"fiber-ui-config-options/#admin_group","title":"ADMIN_GROUP","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP or SSO group mapped to administrators.</p>"},{"location":"fiber-ui-config-options/#auditor_group","title":"AUDITOR_GROUP","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP or SSO group mapped to auditors.</p>"},{"location":"fiber-ui-config-options/#restricted_auditor_group","title":"RESTRICTED_AUDITOR_GROUP","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP or SSO group mapped to restricted auditors.</p>"},{"location":"fiber-ui-config-options/#dataofficer_group","title":"DATAOFFICER_GROUP","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP or SSO group mapped to data officers.</p>"},{"location":"fiber-ui-config-options/#enable_google_auth","title":"ENABLE_GOOGLE_AUTH","text":"<p>Default value: <code>false</code></p> <p>Description: Enable Google OAuth2 authentication.</p>"},{"location":"fiber-ui-config-options/#google_client_id","title":"GOOGLE_CLIENT_ID","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Google OAuth2 client ID.</p>"},{"location":"fiber-ui-config-options/#google_client_secret","title":"GOOGLE_CLIENT_SECRET","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Google OAuth2 client secret.</p>"},{"location":"fiber-ui-config-options/#google_redirect_url","title":"GOOGLE_REDIRECT_URL","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Redirect URL for Google OAuth2 login.</p>"},{"location":"fiber-ui-config-options/#enable_azure_auth","title":"ENABLE_AZURE_AUTH","text":"<p>Default value: <code>false</code></p> <p>Description: Enable Microsoft Azure OAuth2 authentication.</p>"},{"location":"fiber-ui-config-options/#azure_client_id","title":"AZURE_CLIENT_ID","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Azure OAuth2 client ID.</p>"},{"location":"fiber-ui-config-options/#azure_client_secret","title":"AZURE_CLIENT_SECRET","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Azure OAuth2 client secret.</p>"},{"location":"fiber-ui-config-options/#azure_tenant_id","title":"AZURE_TENANT_ID","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Azure Active Directory tenant ID.</p>"},{"location":"fiber-ui-config-options/#azure_redirect_url","title":"AZURE_REDIRECT_URL","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Redirect URL for Azure OAuth2 login.</p>"},{"location":"fiber-ui-config-options/#enable_generic_oauth_auth","title":"ENABLE_GENERIC_OAUTH_AUTH","text":"<p>Default value: <code>false</code></p> <p>Description: Enable generic OAuth2 authentication.</p>"},{"location":"fiber-ui-config-options/#generic_oauth_client_id","title":"GENERIC_OAUTH_CLIENT_ID","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Client ID for generic OAuth2 provider.</p>"},{"location":"fiber-ui-config-options/#generic_oauth_client_secret","title":"GENERIC_OAUTH_CLIENT_SECRET","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Client secret for generic OAuth2 provider.</p>"},{"location":"fiber-ui-config-options/#generic_oauth_redirect_url","title":"GENERIC_OAUTH_REDIRECT_URL","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Redirect URL for generic OAuth2 login.</p>"},{"location":"fiber-ui-config-options/#generic_oauth_auth_url","title":"GENERIC_OAUTH_AUTH_URL","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Authorization URL for generic OAuth2 provider.</p>"},{"location":"fiber-ui-config-options/#generic_oauth_token_url","title":"GENERIC_OAUTH_TOKEN_URL","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Token URL for generic OAuth2 provider.</p>"},{"location":"fiber-ui-config-options/#generic_oauth_userinfo_url","title":"GENERIC_OAUTH_USERINFO_URL","text":"<p>Default value: <code>\"\"</code></p> <p>Description: User info URL for generic OAuth2 provider.</p>"},{"location":"fiber-ui-config-options/#enable_authenticator","title":"ENABLE_AUTHENTICATOR","text":"<p>Default value: <code>true</code></p> <p>Description: Enable TOTP authenticator usage for 2FA.</p>"},{"location":"fiber-ui-config-options/#date_format","title":"DATE_FORMAT","text":"<p>Default value: <code>YYYY/MM/DD</code></p> <p>Description: Default date format used in the UI.</p>"},{"location":"fiber-ui-config-options/#timezone","title":"TIMEZONE","text":"<p>Default value: <code>Europe/Budapest</code></p> <p>Description: Default timezone used by the application.</p>"},{"location":"fiber-ui-config-options/#max_download_messages","title":"MAX_DOWNLOAD_MESSAGES","text":"<p>Default value: <code>100</code></p> <p>Description: Maximum number of messages that can be downloaded at once.</p>"},{"location":"fiber-ui-config-options/#smarthost","title":"SMARTHOST","text":"<p>Default value: <code>\"\"</code></p> <p>Description: SMTP relay host (smarthost) used for restoring emails.</p>"},{"location":"fiber-ui-config-options/#smarthost_port","title":"SMARTHOST_PORT","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Port number for the smarthost.</p>"},{"location":"fiber-ui-config-options/#noreply_email_address","title":"NOREPLY_EMAIL_ADDRESS","text":"<p>Default value: <code>no-reply@archive.example.com</code></p> <p>Description: Default \"no-reply\" email address for the UI when restoring email messages.</p>"},{"location":"fiber-ui-config-options/#enable_ldap_auth","title":"ENABLE_LDAP_AUTH","text":"<p>Default value: <code>false</code></p> <p>Description: Enable LDAP authentication.</p>"},{"location":"fiber-ui-config-options/#ldap_host","title":"LDAP_HOST","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP server host and port.</p>"},{"location":"fiber-ui-config-options/#ldap_base_dn","title":"LDAP_BASE_DN","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Base DN for LDAP searches.</p>"},{"location":"fiber-ui-config-options/#ldap_bind_dn","title":"LDAP_BIND_DN","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Bind DN used for LDAP authentication.</p>"},{"location":"fiber-ui-config-options/#ldap_bind_password","title":"LDAP_BIND_PASSWORD","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Password for LDAP bind DN.</p>"},{"location":"fiber-ui-config-options/#ldap_account_objectclass","title":"LDAP_ACCOUNT_OBJECTCLASS","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP object class for user accounts.</p>"},{"location":"fiber-ui-config-options/#ldap_account_mail_attr","title":"LDAP_ACCOUNT_MAIL_ATTR","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP attribute for user email addresses.</p>"},{"location":"fiber-ui-config-options/#ldap_account_userid_attr","title":"LDAP_ACCOUNT_USERID_ATTR","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP attribute for user ID.</p>"},{"location":"fiber-ui-config-options/#ldap_account_username_attr","title":"LDAP_ACCOUNT_USERNAME_ATTR","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP attribute for username.</p>"},{"location":"fiber-ui-config-options/#ldap_distributionlist_objectclass","title":"LDAP_DISTRIBUTIONLIST_OBJECTCLASS","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP object class for distribution lists.</p>"},{"location":"fiber-ui-config-options/#ldap_distributionlist_mail_attr","title":"LDAP_DISTRIBUTIONLIST_MAIL_ATTR","text":"<p>Default value: <code>\"\"</code></p> <p>Description: LDAP attribute for distribution list email addresses.</p>"},{"location":"fiber-ui-config-options/#enable_imap_auth","title":"ENABLE_IMAP_AUTH","text":"<p>Default value: <code>false</code></p> <p>Description: Enable IMAP authentication.</p>"},{"location":"fiber-ui-config-options/#restore_over_imap","title":"RESTORE_OVER_IMAP","text":"<p>Default value: <code>true</code></p> <p>Description: Allow restoring messages to user mailboxes over IMAP.</p>"},{"location":"fiber-ui-config-options/#imap_server","title":"IMAP_SERVER","text":"<p>Default value: <code>\"\"</code></p> <p>Description: IMAP server address.</p>"},{"location":"fiber-ui-config-options/#imap_folder","title":"IMAP_FOLDER","text":"<p>Default value: <code>INBOX</code></p> <p>Description: IMAP folder where restored emails are delivered.</p>"},{"location":"fiber-ui-config-options/#imap_use_tls","title":"IMAP_USE_TLS","text":"<p>Default value: <code>true</code></p> <p>Description: Use TLS for IMAP connections.</p>"},{"location":"fiber-ui-config-options/#enable_pop3_auth","title":"ENABLE_POP3_AUTH","text":"<p>Default value: <code>false</code></p> <p>Description: Enable POP3 authentication.</p>"},{"location":"fiber-ui-config-options/#pop3_server","title":"POP3_SERVER","text":"<p>Default value: <code>\"\"</code></p> <p>Description: POP3 server address.</p>"},{"location":"fiber-ui-config-options/#pop3_use_tls","title":"POP3_USE_TLS","text":"<p>Default value: <code>true</code></p> <p>Description: Use TLS for POP3 connections.</p>"},{"location":"fiber-ui-config-options/#mailcow_host","title":"MAILCOW_HOST","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Mailcow server address.</p>"},{"location":"fiber-ui-config-options/#mailcow_api_key","title":"MAILCOW_API_KEY","text":"<p>Default value: <code>\"\"</code></p> <p>Description: API key for Mailcow integration.</p>"},{"location":"fiber-ui-config-options/#caution_text","title":"CAUTION_TEXT","text":"<p>Default value: <code>Caution: This message was sent from outside the company.&lt;br /&gt;Please do not click links or open attachments unless you&lt;br /&gt;recognize the source of this email and know the content is safe!</code></p> <p>Description: Warning banner displayed on external messages.</p>"},{"location":"fiber-ui-config-options/#gotenberg_addr","title":"GOTENBERG_ADDR","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Address of Gotenberg service used for document PDF export.</p>"},{"location":"fiber-ui-config-options/#enable_export","title":"ENABLE_EXPORT","text":"<p>Default value: <code>true</code></p> <p>Description: Enable export functionality for messages.</p>"},{"location":"fiber-ui-config-options/#min_size_to_enable_export","title":"MIN_SIZE_TO_ENABLE_EXPORT","text":"<p>Default value: <code>10000000000</code></p> <p>Description: Minimum storage size (bytes) required before export is enabled.</p>"},{"location":"fiber-ui-config-options/#max_export_messages","title":"MAX_EXPORT_MESSAGES","text":"<p>Default value: <code>20000</code></p> <p>Description: Maximum number of messages included in a single export.</p>"},{"location":"fiber-ui-config-options/#export_timeout","title":"EXPORT_TIMEOUT","text":"<p>Default value: <code>300s</code></p> <p>Description: Timeout duration for export jobs.</p>"},{"location":"fiber-ui-config-options/#admin_can_manage_exports","title":"ADMIN_CAN_MANAGE_EXPORTS","text":"<p>Default value: <code>true</code></p> <p>Description: Allow administrators to manage export jobs.</p>"},{"location":"fiber-ui-config-options/#dir_export","title":"DIR_EXPORT","text":"<p>Default value: <code>/var/piler/export</code></p> <p>Description: Directory where exported files are stored.</p>"},{"location":"fiber-ui-config-options/#export_warning_text","title":"EXPORT_WARNING_TEXT","text":"<p>Default value: <code>Exported files will be auto removed in 7 days. Please download them in their scheduled period</code></p> <p>Description: Warning text shown to users about export retention.</p>"},{"location":"fiber-ui-config-options/#enable_delete","title":"ENABLE_DELETE","text":"<p>Default value: <code>false</code></p> <p>Description: Enable delete functionality for messages.</p>"},{"location":"fiber-ui-config-options/#need_to_approve_delete","title":"NEED_TO_APPROVE_DELETE","text":"<p>Default value: <code>false</code></p> <p>Description: Require data officer approval before message deletion.</p>"},{"location":"fiber-ui-config-options/#app_trace_name","title":"APP_TRACE_NAME","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Application trace name (used for distributed tracing).</p>"},{"location":"fiber-ui-config-options/#trace_addr","title":"TRACE_ADDR","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Trace collector address (e.g., OpenTelemetry backend).</p>"},{"location":"fiber-ui-config-options/#turnstile_site_key","title":"TURNSTILE_SITE_KEY","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Cloudflare Turnstile site key.</p>"},{"location":"fiber-ui-config-options/#turnstile_secret_key","title":"TURNSTILE_SECRET_KEY","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Cloudflare Turnstile secret key.</p>"},{"location":"fiber-ui-config-options/#tika_url","title":"TIKA_URL","text":"<p>Default value: <code>http://127.0.0.1:9998/tika</code></p> <p>Description: Apache Tika server endpoint for content extraction.</p>"},{"location":"fiber-ui-config-options/#header_line_to_hide","title":"HEADER_LINE_TO_HIDE","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Comma separated Email header lines (without the colon!) to hide in the UI.</p>"},{"location":"fiber-ui-config-options/#example-header_line_to_hidereceiveddelivered-to","title":"Example: HEADER_LINE_TO_HIDE=Received,Delivered-To","text":""},{"location":"fiber-ui-config-options/#saml_cert_file","title":"SAML_CERT_FILE","text":"<p>Default value: <code>saml.crt</code></p> <p>Description: Path to the SAML certificate file.</p>"},{"location":"fiber-ui-config-options/#saml_key_file","title":"SAML_KEY_FILE","text":"<p>Default value: <code>saml.key</code></p> <p>Description: Path to the SAML private key file.</p>"},{"location":"fiber-ui-config-options/#saml_metadata_url","title":"SAML_METADATA_URL","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Metadata URL for SAML IdP.</p>"},{"location":"fiber-ui-config-options/#tsa_public_key_file","title":"TSA_PUBLIC_KEY_FILE","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Path to public key used to verify timestamp authority signatures.</p>"},{"location":"fiber-ui-config-options/#jwt_rsa_public_keys_dir","title":"JWT_RSA_PUBLIC_KEYS_DIR","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Directory containing RSA public keys for JWT validation.</p>"},{"location":"fiber-ui-config-options/#content_security_policy","title":"CONTENT_SECURITY_POLICY","text":"<p>Default value:</p> <pre><code>default-src 'self'; script-src 'self' 'unsafe-eval' 'sha256-ZswfTY7H35rbv8WC7NXBoiC7WNu86vSzCDChNWwZZDM=' \n'sha256-Sc84R3QT4gTYLl5M2SIYCramZDi3OcEjJiog35/7ydU=' https://cdn.jsdelivr.net https://challenges.cloudflare.com ; \nstyle-src 'self' https://cdn.jsdelivr.net; img-src 'self' data: https://cdn.jsdelivr.net https://challenges.cloudflare.com; \nfont-src 'self' https://cdn.jsdelivr.net; frame-src https://challenges.cloudflare.com; connect-src 'self'; \nobject-src 'none'; base-uri 'none'; form-action 'self'; frame-ancestors 'none';\n</code></pre> <p>Description: Content Security Policy (CSP) header applied by the application.</p>"},{"location":"fiber-ui-config-options/#s3_endpoint","title":"S3_ENDPOINT","text":"<p>Default value: <code>\"\"</code></p> <p>Description: S3-compatible storage endpoint, eg. <code>s3.eu-central-003.backblazeb2.com</code></p>"},{"location":"fiber-ui-config-options/#s3_access_key","title":"S3_ACCESS_KEY","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Access key for S3 storage.</p>"},{"location":"fiber-ui-config-options/#s3_secret_key","title":"S3_SECRET_KEY","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Secret key for S3 storage.</p>"},{"location":"fiber-ui-config-options/#s3_use_ssl","title":"S3_USE_SSL","text":"<p>Default value: <code>true</code></p> <p>Description: Enable SSL/TLS for S3 connections.</p>"},{"location":"fiber-ui-config-options/#s3_region","title":"S3_REGION","text":"<p>Default value: <code>\"\"</code></p> <p>Description: S3 region name.</p>"},{"location":"fiber-ui-config-options/#s3_bucket_prefix","title":"S3_BUCKET_PREFIX","text":"<p>Default value: <code>\"\"</code></p> <p>Description: Prefix applied to S3 buckets.</p>"},{"location":"fiber-ui-config-options/#s3_use_subdirs","title":"S3_USE_SUBDIRS","text":"<p>Default value: <code>true</code></p> <p>Description: Store objects in subdirectories within the S3 bucket.</p>"},{"location":"fiber-ui-config-options/#demo_mode","title":"DEMO_MODE","text":"<p>Default value: <code>false</code></p> <p>Description: Enable demo mode with restricted functionality.</p>"},{"location":"fiber-ui-config-options/#allowed_cidrs","title":"ALLOWED_CIDRS","text":"<p>Default value: <code>127.0.0.0/8,172.18.0.0/16,172.19.0.0/16,172.20.0.0/16</code></p> <p>Description: Defines CIDR blocks allowed to access the <code>/metrics</code> and <code>/healthz</code> endpoints.</p>"},{"location":"new-features-in-2.0.0/","title":"What's new in 2.0.0","text":"<p>This documentation applies to Piler enterprise edition 2.0.0</p> <p>Revision #1</p> <p>Publication date: 2025-SEP-26</p>"},{"location":"new-features-in-2.0.0/#better-ui-performance","title":"Better UI performance","text":"<p>Piler enterprise has a new web app backend. While the 1.x series relies on nginx+PHP, the 2.x series has been rewritten using Go Fiber. Though the look of the UI is the same, the backend offers a much better performance, see the benchmark comparison between fiber and the legacy nginx+php app.</p>"},{"location":"new-features-in-2.0.0/#jwt-token-authentication","title":"JWT token authentication","text":"<p>The REST API uses JWT tokens to authenticate the request.</p>"},{"location":"new-features-in-2.0.0/#support-for-external-authentiation","title":"Support for external authentiation","text":"<p>It's possible to use ED25519 signed JWT tokens to let an external application authenticate users, and grant them a user session in the piler UI.</p>"},{"location":"new-features-in-2.0.0/#audit-records-moved-to-manticore","title":"Audit records moved to Manticore","text":"<p>To offer better searchability, the audit records are written to a manticore table.</p>"},{"location":"new-features-in-2.0.0/#ui-license","title":"UI license","text":"<p>The UI requires a dedicated license file.</p>"},{"location":"new-features-in-2.0.0/#dot-env-style-configuration","title":"Dot-env style configuration","text":"<p>The fiber UI uses an .env file (similar to what node.js apps use) to set various parameters, see the UI config options page what config parameters are available.</p> <p>When having a multi-tenant deployment, the global values can be overridden by setting the per-tenant values in the piler database customer_settings table <code>settings_json</code> column, eg.</p> <pre><code>{\"HEADER_LINK_TITLE\":\"Example archive\", \"HEADER_LINK\":\"https://example.com\"}\n</code></pre>"},{"location":"overview/","title":"Overview of piler enterprise edition","text":"<p>This documentation applies to Piler enterprise edition 2.0.0</p> <p>Revision #1</p> <p>Publication date: 2025-SEP-21</p>"},{"location":"overview/#piler-architecture-overview","title":"Piler architecture overview","text":"<p>Piler is flexible enough to support several configurations and layouts. Use one of the following layouts matching your environment.</p>"},{"location":"overview/#single-node-layout","title":"Single node layout","text":"<p>Figure 1. Single node installation</p> <p>This is the simplest layout, when you have a single node running piler enterprise. It allows you to start small, and expand later as you grow.</p> <p>Piler receives the emails directly, and archives them. The Piler node also runs the UI. To restore the emails it uses the smtp smarthost to deliver emails to the users\u2019 mailboxes.</p>"},{"location":"overview/#multiple-nodes-layout","title":"Multiple nodes layout","text":"<p>Figure 2. Multiple nodes layout</p> <p>A typical installation contains the following nodes:</p> <p>MX server: receives emails from the mail server, and distributes them among the worker nodes based on your preferences</p> <p>Smarthost: receives emails to be restored from the UI node, and delivers them to mail server</p> <p>Worker nodes: run the Piler daemons and archive the received emails</p> <p>UI node: runs the Piler UI allowing users to view their emails</p>"},{"location":"overview/#archive-components","title":"Archive components","text":"<p>Figure 3. Components on the archive host</p> <p>Piler enterprise features the following components:</p> <ul> <li>piler binaries and daemons: archiving emails</li> <li>web appp: display the UI the REST API</li> <li>mysql: store crucial metadata</li> <li>manticore: search index and audit logs</li> <li>redis/valkey cache: store user sessions and other user data</li> <li>reverse proxy, eg. traefik, nginx: provide https entrypoint</li> </ul>"},{"location":"overview/#platform-requirements","title":"Platform requirements","text":"<p>Supported platforms:</p> <ul> <li>Ubuntu 24.04 LTS (Noble)</li> <li>Centos 10</li> <li>Docker compose (on any Linux ditro)</li> </ul> <p>Note that piler supports both x64 and arm64 platforms.</p>"},{"location":"overview/#hardware-requirements","title":"Hardware requirements","text":"<p>Piler can be installed on physical hardware, virtual machine (VMware, etc), in the cloud (AWS, etc) or in a Docker container. Piler requires:</p> <ul> <li>2+ GB memory</li> <li>2+ (v)CPU</li> <li>200+ GB disk space</li> </ul> <p>Note that piler stores data in /var/piler/store and /var/piler/astore directories. Expect to have several millions of files in various size ranging from few kB to several MB.</p> <p>See the email archive sizing calculator for more</p> <p>Piler also supports S3 compatible object stores, see section S3 object store for more details.</p>"},{"location":"rest/","title":"REST API","text":""},{"location":"rest/#get-the-jwt-access-token","title":"Get the JWT access token","text":"<pre><code>ACCESS_TOKEN=\"$( curl -s -X POST \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\"username\":\"user@example.com\", \"password\":\"password\"}' \\\n    \"https://archive.example.com/auth/login\" | jq -r '.access_token' )\"\n</code></pre>"},{"location":"rest/#domain-handling","title":"Domain handling","text":"<p>\"${CURL[@]}\" -XPOST -d '{\"domain\":\"gmail.com\",\"mapped\":\"fictive.com\",\"ldap_id\":2}' \"${SITE_URL}/api/admin/domain/add\"</p> <p>Get domains:</p> <p>GET: https://archive.example.com/api/admin/domain</p> <p>Add a domain:</p> <p>POST: https://archive.example.com/api/admin/domain/add</p>"},{"location":"s3-storage/","title":"Using S3 object store","text":"<p>By default piler stores email files on the local filesystem under /var/piler subdirectories, thus requiring lots of disk space.</p> <p>Piler is able to store files on S3 compatible object stores, eg. Amazon S3, Wasabi, Exoscale, etc. Or you can even set up your own S3 object store with 3rd party software like Minio. Note that you should decide where to store the email files before starting archiving. Piler doesn\u2019t support a mixed mode where some emails are stored locally, and some emails on an S3 object store.</p> <p>When using S3 storage the piler daemon writes all files to /var/piler/s3 directory. Then a piler service processes these files, and upload them to the S3 store.</p> <p>Piler will upload all files for a given tenant to a single bucket only.</p>"},{"location":"s3-storage/#enable-the-s3-storage","title":"Enable the S3 storage","text":"<p>To enable using an S3 store, set the following in /etc/piler/piler.conf:</p> <pre><code>s3_hostname=your-s3-host.domain.com:9000\ns3_region=us-east-1\ns3_access_key=youraccesskey\ns3_secret_key=yoursecretkey\ns3_bucket_prefix=\ns3_dir=/var/piler/s3\ns3_use_subdirs=1\ns3_threads=10\ns3_secure=1\n</code></pre> <p>s3_hostname should be the S3 hostname and port. Eg. Minio uses port 9000. For Wasabi, it might be s3.us-west-1.wasabisys.com.</p> <p>Set <code>s3_secure=0</code> if your S3 host does NOT support TLS.</p> <p>By default s3_bucket_prefix is empty. If you need to specify one, then make sure it conforms to domain names.</p> <p>Notes: you must NOT use the dash (-) character, however you may use a trailing dot, eg.</p> <pre><code>s3_bucket_prefix=someprefix.\n</code></pre> <p>S3 settings for oracle cloud:</p> <pre><code>s3_access_key=youraccesskey\ns3_bucket_prefix=\ns3_dir=/var/piler/s3\ns3_hostname=frnsjgsfvvgl.compat.objectstorage.eu-frankfurt-1.oraclecloud.com\ns3_region=eu-frankfurt-1\ns3_secret_key=yoursecretkey\ns3_secure=1\ns3_threads=10\ns3_use_subdirs=1\n</code></pre> <p>S3 settings for Cloudflare bucket using EU jurisdiction:</p> <pre><code>s3_access_key=xxxxxxxxxxxxxxxxxx\ns3_bucket_prefix=\ns3_dir=/var/piler/s3\ns3_hostname=zzzzzzzzzzzzzzzzz.eu.r2.cloudflarestorage.com\ns3_region=auto\ns3_secret_key=yyyyyyyyyyyyyyyyyyyyyyyyyyyyy\ns3_secure=1\ns3_threads=10\ns3_use_subdirs=1\n</code></pre> <p>S3 settings for Backblaze bucket using EU-central:</p> <p>(Note: Backblaze doesn't accept dot (.) in the bucket name!)</p> <pre><code>s3_access_key=xxxxxxxxxxxxxxxxxx\ns3_bucket_prefix=\ns3_dir=/var/piler/s3\ns3_hostname=s3.eu-central-003.backblazeb2.com\ns3_region=us-east-1\ns3_secret_key=yyyyyyyyyyyyyyyyyyyyyyyyyyyyy\ns3_secure=1\ns3_threads=10\ns3_use_subdirs=1\n</code></pre> <p>S3 settings for Hetzner object store at fsn1 location:</p> <pre><code>s3_access_key=xxxxxxxxxxxxxxxxxx\ns3_bucket_prefix=\ns3_dir=/var/piler/s3\ns3_hostname=&lt;your hetzner id&gt;.fsn1.your-objectstorage.com\ns3_region=us-east-1\ns3_secret_key=yyyyyyyyyyyyyyyyyyyyyyyyyyyyy\ns3_secure=1\ns3_threads=10\ns3_use_subdirs=1\n</code></pre>"},{"location":"s3-storage/#update-the-ui-config","title":"Update the UI config","text":"<p>Put the S3 configuration to the UI env file as well. This is for a minio installation on port 9000 with no TLS configured:</p> <pre><code>RETRIEVER_METHOD=s3\nS3_ENDPOINT=minio:9000\nS3_ACCESS_KEY=root\nS3_SECRET_KEY=example156\nS3_USE_SSL=false\nS3_REGION=us-east-1\n</code></pre>"},{"location":"s3-storage/#enable-the-the-piler-s3-service","title":"Enable the the piler-s3 service","text":"<pre><code>cd /etc/systemd/system\nln -sf /usr/libexec/piler/piler-s3.service .\nsystemctl daemon-reload\nsystemctl enable piler-s3\nsystemctl start piler-s3\n</code></pre>"},{"location":"s3-storage/#s3-statistics","title":"S3 statistics","text":"<p>To allow S3 statistics you need to install the minio client:</p> <pre><code>curl -o /usr/local/bin/mc https://dl.min.io/client/mc/release/linux-amd64/mc\nchmod +x /usr/local/bin/mc\n</code></pre> <p>Then create a config file for minio:</p> <pre><code>su - piler\nmkdir -p /var/piler/.mc/\n</code></pre> <p>Create /var/piler/.mc/config.json. In the below example we used the following parameters (be sure to use your own settings):</p> <pre><code>s3_hostname=https://zzzzzzzzzzzzzzzzz.eu.r2.cloudflarestorage.com\ns3_access_key=aabbaabbaabb\ns3_secret_key=deadbeef0123456789abcdef\n</code></pre> <p>/var/piler/.mc/config.json:</p> <pre><code>{\"version\":\"10\", \"aliases\": {\"minio\": {\"url\":\"https://zzzzzzzzzzzzzzzzz.eu.r2.cloudflarestorage.com\",\"accessKey\":\"aabbaabbaabb\", \"secretKey\": \"deadbeef0123456789abcdef\", \"api\": \"S3v4\", \"path\": \"auto\"}}}\n</code></pre> <p>Then finally add the following to piler's crontab entries:</p> <pre><code>30 * * * * /usr/libexec/piler/s3-bucket-stat.sh minio\n</code></pre> <p>This will update the s3_bucket_stats table in the mysql piler database every hour. The result looks like the following. These details will be displayed at the tenant listing.</p> <pre><code>MariaDB [piler]&gt; select * from s3_bucket_stat;\n+---------+----------+---------+---------------------+\n| bucket  | size     | objects | t                   |\n+---------+----------+---------+---------------------+\n| fictive | 20481360 |    2978 | 2024-02-06 10:30:08 |\n+---------+----------+---------+---------------------+\n1 row in set (0.001 sec)\n</code></pre>"},{"location":"security/","title":"Securing the archive","text":"<p>This documentation applies to Piler enterprise edition 2.0.0</p> <p>Revision #1</p> <p>Publication date: 2025-SEP-23</p>"},{"location":"security/#single-node-layout","title":"Single node layout","text":"<p>The piler node should be accessed on port 443 from the Internet. Port 25 should be limited to your mail servers, also see the SMTP ACL feature below.</p>"},{"location":"security/#multiple-nodes-layout","title":"Multiple nodes layout","text":"<p>UI node ports accessibility:</p> <ul> <li>tcp/443: from the Internet</li> <li>tcp/3306: from the worker nodes</li> </ul> <p>The worker nodes ports accessibility:</p> <ul> <li>tcp/25: only the MX server</li> <li>tcp/80,443: only the UI node</li> <li>tcp/9312: only the UI node</li> </ul> <p>MX server ports accessibility:</p> <ul> <li>tcp/25: only from your mail servers</li> </ul> <p>It's also possible to use an internal network where the worker nodes' ports and the UI node mysql port are available.</p>"},{"location":"security/#starttls-support","title":"STARTTLS support","text":"<p>By default the installer creates a key and a self-signed certificate (/etc/piler/piler.pem) to support STARTTLS providing encrypted message transfer between the smtp client and the Piler smtp server. You are free to fix piler.pem to use your signed CA.</p>"},{"location":"security/#smtp-acl-lists","title":"SMTP ACL lists","text":"<p>Piler supports an smtp acl list similar to postscreen. See https://mailpiler.com/smtp-acl-list/ for more.</p>"},{"location":"security/#antivirus-and-antispam-support","title":"Antivirus and antispam support","text":"<p>Piler expects clean emails only. Spam and other malware occupy valuable disk space and other resources on the piler host, not to mention that it might pose other problems. So you should do the heavy lifting of scanning and filtering of any spam and malware on your MX servers.</p> <p>However, Piler is able to use the result of any antispam application, provided that it sets a specific email header to mark spam emails. If you used SpamAssassin, then you may use the following setting in /etc/piler/piler.conf, then piler can recognize when it receives a spam:</p> <pre><code>spam_header_line=X-Spam-Flag: YES\n</code></pre> <p>If piler recognizes a spam, then you may set an exlusion rule to discard it (preventing from getting to the archive) or archive it for a shorter time, eg. 30 days or so.</p> <p>Note that piler supports a single spam header line, ie. you cannot specify the anti-spam headers of several anti-spam products. However, by using an SMTP it\u2019s possible to rewrite several kind of antispam headers to a unified value. See https://mailpiler.com/consolidating-several-anti-spam-message-headers-on-the-smtp-gateway/ for more.</p>"},{"location":"setup/","title":"Installing piler enterprise edition","text":"<p>This documentation applies to Piler enterprise edition 2.0.0</p> <p>Revision #1</p> <p>Publication date: 2025-SEP-21</p>"},{"location":"setup/#installing-a-no-tenant-configuration-on-a-single-node-using-docker-compose","title":"Installing a no-tenant configuration on a single node using docker compose","text":"<p>There's a docker compose stack that deploys all the necessary components. Follow the instructions in the README.</p>"},{"location":"setup/#installing-a-no-tenant-configuration-on-a-single-linux-vm-node","title":"Installing a no-tenant configuration on a single Linux VM node","text":"<p>Pick the installer for either Ubuntu 24.04 LTS (noble.sh) or Centos/Redhat/Oracle 10 (centos10.sh). In this example we pick Ubuntu.</p> <p>Customise the following variables:</p> <ul> <li>PILER_HOSTNAME</li> <li>MYSQL_ROOT_PASSWORD</li> <li>MYSQL_PILER_PASSWORD</li> <li>ARCH (either \"amd64\" or \"arm64\")</li> </ul> <p>Execute the installer</p> <pre><code>curl -o noble.sh https://download.mailpiler.com/noble.sh\nchmod +x noble.sh\nsudo ./noble.sh\n</code></pre> <p>Copy both license files (piler.lic and license.jwt) to /etc/piler directory, then reboot the host, and verify that all services come up properly.</p>"},{"location":"setup/#centosredhatoracle-linux-specific-notes","title":"Centos/Redhat/Oracle Linux specific notes","text":"<p>SELinux is enabled by default. Please either disable it, or configure it properly.</p>"},{"location":"tuning/","title":"Tuning the archive","text":""},{"location":"tuning/#mysql","title":"Mysql","text":"<p>By default the installer sets modest buffer sizes. If you have +8 GB memory, try these settings:</p> <pre><code>[mysqld]\ninnodb_buffer_pool_size = 2.5G\ninnodb_buffer_pool_instances = 4\ninnodb_log_file_size = 512M\ninnodb_log_buffer_size = 128M\ninnodb_flush_log_at_trx_commit = 1\ninnodb_flush_neighbors = 0\ninnodb_file_per_table = 1\ninnodb_io_capacity = 800\ninnodb_io_capacity_max = 1600\ninnodb_read_io_threads = 4\ninnodb_write_io_threads = 4\n\nthread_handling = pool-of-threads\n\nmax_connections = 250\ntable_open_cache = 4000\nopen_files_limit = 65535\nskip_name_resolve = 1\n\ntmp_table_size = 128M\nmax_heap_table_size = 128M\naria_pagecache_buffer_size = 128M\n\nquery_cache_type = 0\nquery_cache_size = 0\nperformance_schema = OFF\n</code></pre> <p>Systemd overrides (/etc/systemd/system/mariadb.service.d/override.conf)</p> <pre><code>[Service]\nLimitNOFILE=65535\n</code></pre>"},{"location":"tuning/#linux-sysctl-tunings","title":"Linux sysctl tunings","text":"<pre><code># MariaDB + general DB workload tuning\nvm.swappiness = 1\nvm.dirty_background_ratio = 5\nvm.dirty_ratio = 15\nfs.file-max = 2097152\n\n# Networking\nnet.core.somaxconn = 65535\nnet.ipv4.tcp_fin_timeout = 10\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_keepalive_time = 300\nnet.ipv4.tcp_keepalive_intvl = 60\nnet.ipv4.tcp_keepalive_probes = 9\n</code></pre>"},{"location":"tuning/#manticore","title":"Manticore","text":"<p>Try these settings if you have +8 GB memory:</p> <pre><code>searchd {\n    ...\n    rt_mem_limit = 2G\n    workers = threads\n    dist_threads = 4\n    max_children = 30\n}\n</code></pre>"},{"location":"tuning/#piler","title":"Piler","text":"<p>The number of worker processes should be the number of cpu cores + 1, eg. for 2 CPUs: 3</p> <p>The piler-smtp daemon buffers the email to memory. The <code>max_message_size</code> variable determines the max message size that piler-smtp accepts. The <code>max_smtp_memory</code> variable caps the max allocatable memory that piler-smtp may claim. Be sure to set these to match your needs in /etc/piler/piler.conf:</p> <pre><code>max_message_size=50000000\nmax_smtp_memory=500000000\n# having 2 cpus\nnumber_of_worker_processes=3\n\n</code></pre>"},{"location":"upgrade/","title":"Upgrading","text":"<p>This documentation applies to Piler enterprise edition 2.0.0</p> <p>Revision #1</p> <p>Publication date: 2025-SEP-26</p> <p>The 2.x version ships a brand new web app that is not compatible with the old one, has a different configuration mechanism, and has a few prerequisites</p>"},{"location":"upgrade/#prerequisites","title":"Prerequisites","text":"<ul> <li>real time index</li> <li>dynamic indexes when using a multi-tenant deployment</li> </ul>"},{"location":"upgrade/#upgrade-steps","title":"Upgrade steps","text":"<p>...</p>"}]}